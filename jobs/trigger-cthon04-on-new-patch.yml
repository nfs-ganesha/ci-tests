- job:
    name: trigger-cthon04-on-new-patch
    node: cico-workspace
    description: 'Start cthon04 test when a new patch is posted to GerritHub.' 
    project-type: freestyle
    concurrent: false
    allow-manual-triggers: false 

    scm:
    - ci-tests

    properties:
    - nfs-github

    builders:
      - trigger-builds:
        - project: cthon04
          block: true
          block-thresholds:
            build-step-failure-threshold: never
            unstable-threshold: never
            failure-threshold: never
          predefined-parameters: |
            CENTOS_VERSION=8s
            CENTOS_ARCH=x86_64
            GERRIT_HOST=${GERRIT_HOST}
            GERRIT_PROJECT=${GERRIT_PROJECT}
            GERRIT_REFSPEC=${GERRIT_REFSPEC}
      - shell: |
          bash $WORKSPACE/ci-tests/build_scripts/common/add-gerrit-comment.sh

    triggers:
    - gerrithub-trigger:
        option: 'cthon04'

    wrappers:
    - gerrithub_key
